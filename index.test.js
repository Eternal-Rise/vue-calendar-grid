import { describe, it, expect } from 'vitest';
import { useCalendarGrid } from './index.js';

describe('useCalendarGrid', () => {
  describe('weekGrid', () => {
    it.each([
      // week starts on Sunday
      ['2020-01-01', 0, 1, [29, 30, 31, 1, 2, 3, 4]],
      ['2020-12-31', 0, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2021-01-01', 0, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2021-12-31', 0, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2022-01-01', 0, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2022-12-31', 0, 53, [25, 26, 27, 28, 29, 30, 31]],
      ['2023-01-01', 0, 1, [1, 2, 3, 4, 5, 6, 7]],
      ['2023-12-31', 0, 1, [31, 1, 2, 3, 4, 5, 6]],
      ['2024-01-01', 0, 1, [31, 1, 2, 3, 4, 5, 6]],
      ['2024-12-31', 0, 1, [29, 30, 31, 1, 2, 3, 4]],
      ['2025-01-01', 0, 1, [29, 30, 31, 1, 2, 3, 4]],
      ['2025-12-31', 0, 1, [28, 29, 30, 31, 1, 2, 3]],
      ['2026-01-01', 0, 1, [28, 29, 30, 31, 1, 2, 3]],
      ['2026-12-31', 0, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2027-01-01', 0, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2027-12-31', 0, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2028-01-01', 0, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2028-12-31', 0, 1, [31, 1, 2, 3, 4, 5, 6]],
      ['2029-01-01', 0, 1, [31, 1, 2, 3, 4, 5, 6]],
      ['2029-12-31', 0, 1, [30, 31, 1, 2, 3, 4, 5]],
      ['2030-01-01', 0, 1, [30, 31, 1, 2, 3, 4, 5]],
      ['2030-12-31', 0, 1, [29, 30, 31, 1, 2, 3, 4]],

      // week starts on Monday
      ['2020-01-01', 1, 1, [30, 31, 1, 2, 3, 4, 5]],
      ['2020-12-31', 1, 1, [28, 29, 30, 31, 1, 2, 3]],
      ['2021-01-01', 1, 1, [28, 29, 30, 31, 1, 2, 3]],
      ['2021-12-31', 1, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2022-01-01', 1, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2022-12-31', 1, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2023-01-01', 1, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2023-12-31', 1, 53, [25, 26, 27, 28, 29, 30, 31]],
      ['2024-01-01', 1, 1, [1, 2, 3, 4, 5, 6, 7]],
      ['2024-12-31', 1, 1, [30, 31, 1, 2, 3, 4, 5]],
      ['2025-01-01', 1, 1, [30, 31, 1, 2, 3, 4, 5]],
      ['2025-12-31', 1, 1, [29, 30, 31, 1, 2, 3, 4]],
      ['2026-01-01', 1, 1, [29, 30, 31, 1, 2, 3, 4]],
      ['2026-12-31', 1, 1, [28, 29, 30, 31, 1, 2, 3]],
      ['2027-01-01', 1, 1, [28, 29, 30, 31, 1, 2, 3]],
      ['2027-12-31', 1, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2028-01-01', 1, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2028-12-31', 1, 53, [25, 26, 27, 28, 29, 30, 31]],
      ['2029-01-01', 1, 1, [1, 2, 3, 4, 5, 6, 7]],
      ['2029-12-31', 1, 1, [31, 1, 2, 3, 4, 5, 6]],
      ['2030-01-01', 1, 1, [31, 1, 2, 3, 4, 5, 6]],
      ['2030-12-31', 1, 1, [30, 31, 1, 2, 3, 4, 5]],

      // week starts on Saturday
      ['2020-01-01', 6, 1, [28, 29, 30, 31, 1, 2, 3]],
      ['2020-12-31', 6, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2021-01-01', 6, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2021-12-31', 6, 53, [25, 26, 27, 28, 29, 30, 31]],
      ['2022-01-01', 6, 1, [1, 2, 3, 4, 5, 6, 7]],
      ['2022-12-31', 6, 1, [31, 1, 2, 3, 4, 5, 6]],
      ['2023-01-01', 6, 1, [31, 1, 2, 3, 4, 5, 6]],
      ['2023-12-31', 6, 1, [30, 31, 1, 2, 3, 4, 5]],
      ['2024-01-01', 6, 1, [30, 31, 1, 2, 3, 4, 5]],
      ['2024-12-31', 6, 1, [28, 29, 30, 31, 1, 2, 3]],
      ['2025-01-01', 6, 1, [28, 29, 30, 31, 1, 2, 3]],
      ['2025-12-31', 6, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2026-01-01', 6, 1, [27, 28, 29, 30, 31, 1, 2]],
      ['2026-12-31', 6, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2027-01-01', 6, 1, [26, 27, 28, 29, 30, 31, 1]],
      ['2027-12-31', 6, 53, [25, 26, 27, 28, 29, 30, 31]],
      ['2028-01-01', 6, 1, [1, 2, 3, 4, 5, 6, 7]],
      ['2028-12-31', 6, 1, [30, 31, 1, 2, 3, 4, 5]],
      ['2029-01-01', 6, 1, [30, 31, 1, 2, 3, 4, 5]],
      ['2029-12-31', 6, 1, [29, 30, 31, 1, 2, 3, 4]],
      ['2030-01-01', 6, 1, [29, 30, 31, 1, 2, 3, 4]],
      ['2030-12-31', 6, 1, [28, 29, 30, 31, 1, 2, 3]],
    ])(
      'returns proper grid for %s where week starts on %i',
      (date, weekStart, week, dates) => {
        const { weekGrid } = useCalendarGrid({ date, weekStart });
        const weekDates = weekGrid.value.days.map((day) => day.date);
        expect(weekGrid.value.week).toBe(week);
        expect(weekDates).toEqual(dates);
      },
    );
  });
});
